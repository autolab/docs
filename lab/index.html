
<!DOCTYPE html>
<html class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="shortcut icon" href="../assets/images/favicon.ico">
      
      <meta name="generator" content="mkdocs+mkdocs-material#1.0.3">
    
    
      
        <title>Guide for Lab Authors - Autolab Docs</title>
      
    
    
      <script src="../assets/javascripts/modernizr-facb31f4a3.js"></script>
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application-bc099a55ca.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-02ce7adcc2.palette.css">
      
      
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="red" data-md-color-accent="">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Autolab Docs" class=" md-logo  md-header-nav__button">
          
            <img src="../images/logo.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Autolab
                </span>
              
            
            Guide for Lab Authors
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <div class="md-search__overlay"></div>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false">
      <label class="md-icon md-search__icon" for="search"></label>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result"></div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            
              


  


  <a href="https://github.com/Autolab/autolab" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Autolab
    </div>
  </a>

            
          </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <i class=" md-logo  md-nav__button">
      
        <img src="../images/logo.svg">
      
    </i>
    Autolab Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/Autolab/autolab" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Autolab
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1" checked>
    
    <label class="md-nav__link" for="nav-1">
      Autolab
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-1">
        Autolab
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href=".." title="Getting Started" class="md-nav__link">
        Getting Started
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../instructors/" title="Guide for Instructors" class="md-nav__link">
        Guide for Instructors
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Guide for Lab Authors
      </label>
    
    <a href="./" title="Guide for Lab Authors" class="md-nav__link md-nav__link--active">
      Guide for Lab Authors
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#writing-autograders" title="Writing Autograders" class="md-nav__link">
    Writing Autograders
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-autograded-labs" title="Installing Autograded Labs" class="md-nav__link">
    Installing Autograded Labs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-an-autograded-lab-from-scratch" title="Creating an Autograded Lab from Scratch" class="md-nav__link">
    Creating an Autograded Lab from Scratch
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-new-lab" title="Step 1: Create the new lab." class="md-nav__link">
    Step 1: Create the new lab.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-the-lab-for-autograding" title="Step 2: Configure the lab for autograding." class="md-nav__link">
    Step 2: Configure the lab for autograding.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-add-the-required-autograding-files" title="Step 3: Add the required autograding files." class="md-nav__link">
    Step 3: Add the required autograding files.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importing-an-autograded-lab-from-a-previous-semester" title="Importing an Autograded Lab from a Previous Semester" class="md-nav__link">
    Importing an Autograded Lab from a Previous Semester
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-hello-lab" title="Example: Hello Lab" class="md-nav__link">
    Example: Hello Lab
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#directory-structure" title="Directory Structure" class="md-nav__link">
    Directory Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-directory" title="Source Directory" class="md-nav__link">
    Source Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handout-directory" title="Handout Directory" class="md-nav__link">
    Handout Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autograder" title="Autograder" class="md-nav__link">
    Autograder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-autograding-files" title="Required Autograding Files" class="md-nav__link">
    Required Autograding Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-directory" title="Test Directory" class="md-nav__link">
    Test Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writeup-directory" title="Writeup directory" class="md-nav__link">
    Writeup directory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Tango
    </label>
    <nav class="md-nav" data-md-component="collapsible">
      <label class="md-nav__title" for="nav-2">
        Tango
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
  <li class="md-nav__item">
    
      <a href="../tango/" title="Getting Started" class="md-nav__link">
        Getting Started
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../tango-rest/" title="REST API" class="md-nav__link">
        REST API
      </a>
    
  </li>

        
          
          
  <li class="md-nav__item">
    
      <a href="../tango-vmms/" title="VMMS API" class="md-nav__link">
        VMMS API
      </a>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#writing-autograders" title="Writing Autograders" class="md-nav__link">
    Writing Autograders
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-autograded-labs" title="Installing Autograded Labs" class="md-nav__link">
    Installing Autograded Labs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-an-autograded-lab-from-scratch" title="Creating an Autograded Lab from Scratch" class="md-nav__link">
    Creating an Autograded Lab from Scratch
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-the-new-lab" title="Step 1: Create the new lab." class="md-nav__link">
    Step 1: Create the new lab.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-the-lab-for-autograding" title="Step 2: Configure the lab for autograding." class="md-nav__link">
    Step 2: Configure the lab for autograding.
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-add-the-required-autograding-files" title="Step 3: Add the required autograding files." class="md-nav__link">
    Step 3: Add the required autograding files.
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importing-an-autograded-lab-from-a-previous-semester" title="Importing an Autograded Lab from a Previous Semester" class="md-nav__link">
    Importing an Autograded Lab from a Previous Semester
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example-hello-lab" title="Example: Hello Lab" class="md-nav__link">
    Example: Hello Lab
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#directory-structure" title="Directory Structure" class="md-nav__link">
    Directory Structure
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#source-directory" title="Source Directory" class="md-nav__link">
    Source Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handout-directory" title="Handout Directory" class="md-nav__link">
    Handout Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autograder" title="Autograder" class="md-nav__link">
    Autograder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#required-autograding-files" title="Required Autograding Files" class="md-nav__link">
    Required Autograding Files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-directory" title="Test Directory" class="md-nav__link">
    Test Directory
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writeup-directory" title="Writeup directory" class="md-nav__link">
    Writeup directory
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
               
              
                
                  <h1>Guide for Lab Authors</h1>
                
                <p>This guide explains how to create autograded programming assignments (labs) for the Autolab system. </p>
<h2 id="writing-autograders">Writing Autograders</h2>
<p>An <em>autograder</em> is a program that takes a student's work as input, and generates some quantitative evaluation of that work as output. The student's work consists of one or more source files written in an arbitrary programming language. 
The autograder processes these files and generates arbitrary text lines on stdout. The last text line on stdout must be a JSON string, called an <em>autoresult</em>, that assigns an autograded score to one or more problems, and optionally, generates the scoreboard entries for this submission.</p>
<p>The JSON autoresult is a "scores" hash that assigns a numerical score to one or more problems, and an optional "scoreboard" array that provides the scoreboard entries for this submission. For example, </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>{&quot;scores&quot;: {&quot;Prob1&quot;: 10, &quot;Prob2&quot;: 5}}
</pre></div>
</td></tr></table>

<p>assigns 10 points to "Prob1" and 5 points to "Prob2" for this submission. The names of the problems must exactly match the names of the problems for this lab on the Autolab web site. Not all problems need to be autograded. For example, there might be a problem for this assessment called "Style" that you grade manually after the due date. </p>
<p>If you used the Autolab web site to configure a scoreboard for this lab with three columns called "Prob1", "Prob2", and "Total", then the autoresult might be: </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>{&quot;scores&quot;: {&quot;Prob1&quot;: 10, &quot;Prob2&quot;: 5}, &quot;scoreboard&quot;: [10, 5, 15]}
</pre></div>
</td></tr></table>

<p>By convention, an autograder accepts an optional <code>-A</code> command line argument that tells it to emit the JSON autoresult. So if you run the autograder outside of the context of Autolab, you can suppress the autoresult line by calling the autograder without the <code>-A</code> argument.</p>
<p>One of the nice properties of Autolab autograders is that they can be written and tested offline, without requiring any interaction with Autolab. Writing autograders is not easy, but the fact that they can be developed offline allows you to develop and test them in your own familiar computing environment. </p>
<h2 id="installing-autograded-labs">Installing Autograded Labs</h2>
<p>After you've written and tested the autograder, you then use the Autolab web site to create the autograded lab. Autolab supports creating new labs from scratch, or reusing labs from previous semesters. We'll describe each of these in turn.</p>
<h3 id="creating-an-autograded-lab-from-scratch">Creating an Autograded Lab from Scratch</h3>
<h4 id="step-1-create-the-new-lab">Step 1: Create the new lab.</h4>
<p>Create a new lab by clicking the "Install Assessment" button and choosing "Option 1: Create a New Assessment from Scratch." For course <code>&lt;course&gt;</code> and lab <code>&lt;lab&gt;</code>,  this will create a <i>lab directory</i> in the Autolab file hierarchy called <code>courses/&lt;course&gt;/&lt;lab&gt;</code>. This initial directory contains a couple of config files and a directory called <code>&lt;lab&gt;/handin</code> that will contain all of the student handin files. In general, you should never modify any of these. </p>
<div class="admonition warning">
<p class="admonition-title">Attention CMU Lab Authors</p>
<p>At CMU, the lab directory is called <code>/afs/cs/academic/class/&lt;course&gt;/autolab/&lt;lab&gt;</code>. For example: <code>/afs/cs/academic/class/15213-f16/autolab/foo</code> is the lab directory for the lab named <code>foo</code> for the Fall 2016 instance of 15-213. All lab-related files must go in this <code>autolab</code> directory to avoid permissions issues.</p>
</div>
<h4 id="step-2-configure-the-lab-for-autograding">Step 2: Configure the lab for autograding.</h4>
<p>Using the "Edit Assessment" page, turn on autograding for this lab by selecting "Add Autograder." You will be asked for the name of the image to be used for autograding this lab. The default image distributed with Autolab is an Ubuntu image called <code>autograding_image</code>. If your class needs different software, then you or your facilities staff will need to update the default image or create a new one. </p>
<div class="admonition warning">
<p class="admonition-title">Attention CMU Lab Authors</p>
<p>The default autograding image at CMU is called <code>rhel.img</code> and is a copy of the software on the CMU Andrew machines (<code>linux.andrew.cmu.edu</code>). If you need custom software installed, please send mail to autolab-help@andrew.cmu.edu.</p>
</div>
<p>If you want a scoreboard, you should select "Add Scoreboard," which will allow you to specify the number of columns and their names. The "Add Scoreboard" page contains a tutorial on how to do this. </p>
<p>You'll also need to define the names and point values for all the problems in this lab, including the autograded ones. </p>
<p>Each student submission is a single file, either a text source file or an archive file containing multiple files and directories. You'll need to specify the <em>base name</em> for the student submission files (e.g., <code>mm.c</code>, <code>handin.tar</code>).</p>
<h4 id="step-3-add-the-required-autograding-files">Step 3: Add the required autograding files.</h4>
<p>For an autograded lab, Autolab expects the following two <em>autograding files</em> in the lab directory: </p>
<ul>
<li><code>autograde-Makefile</code>: runs the autograder on a student submission.</li>
<li><code>autograde.tar</code>: contains all of the files (except for the student handin file) that are needed for autograding. </li>
</ul>
<p>Each time a student submits their work or an instructor requests a regrade, Autolab </p>
<ol>
<li>copies the student handin file, along with the two autograding files, to an empty directory on an <em>autograding instance</em>, </li>
<li>renames the student handin file to <em>base name</em> (e.g., hello.c, handin.tar), </li>
<li>renames <code>autograde-Makefile</code> to <code>Makefile</code>, </li>
<li>executes the command <code>make</code> on the autograding instance, and finally </li>
<li>captures the stdout generated by the autograder, and parses the resulting JSON autoresult to determine the autograded scores. </li>
</ol>
<h3 id="importing-an-autograded-lab-from-a-previous-semester">Importing an Autograded Lab from a Previous Semester</h3>
<p>If you've created a lab for a course in a previous semester and have access to the lab directory (as we do at CMU via AFS), you can import the lab into your current course by </p>
<ol>
<li>copying the lab directory from the previous course to the current course, </li>
<li>cleaning out the <code>handin</code> directory, then </li>
<li>visiting the "Install Assessment" page and selecting "Option 2: Import an existing assessment from the file system." Autolab will give you a list of all of the directories that appear to be uninstalled labs, from which you can select your particular lab. </li>
</ol>
<p>If you don't have access to the lab directory, another option is to import a lab from a tarball that was created by running "Export assessment" in an instance of a lab from a previous semester. Visit the "Install Assessment" page and select "Option 3: Import an existing assessment from tarball." This will upload the tarball, create a new lab directory by expanding the tarball, and then import the directory.</p>
<h2 id="example-hello-lab">Example: Hello Lab</h2>
<p>In this section we'll look at the simplest possible autograded lab we could imagine, called, appropriately enough, the
<a href="https://github.com/autolab/Autolab/tree/master/examples/hello">Hello Lab</a> 
(with <a href="https://github.com/autolab/Autolab/tree/master/examples/hello.tar">tarball</a>), which is stored in a lab directory called <code>hello</code> in the Autolab github repo. While it's trivial, it illustrates all of the aspects of developing an autograded lab, and provides a simple example that you can use for sanity testing on your Autolab installation.</p>
<p>In this lab, students are asked to write a version of the K&amp;R "hello, world" program, called <code>hello.c</code>. The autograder simply checks that the submitted <code>hello.c</code> program compiles and runs with an exit status of zero. If so, the submission gets 100 points. Otherwise it gets 0 points. </p>
<h3 id="directory-structure">Directory Structure</h3>
<p>Autolab expects to find the <code>autograde-Makefile</code>and <code>autograde.tar</code> files in the <code>hello</code> lab directory, but otherwise places no constraints on the contents and organization of this directory. However, based on our experience, we strongly recommend a directory structure with the following form:</p>
<p><a href="https://github.com/autolab/Autolab/tree/master/examples/hello/README">hello/README</a>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="codehilite"><pre><span></span># Basic files created by the lab author
Makefile                Builds the lab from src/
README                  
autograde-Makefile      Makefile that runs the autograder 
src/                    Contains all src files and solutions         
test-autograder/        For testing autograder offline
writeup/                Lab writeup that students view from Autolab    

# Files created by running make
hello-handout/          The directory that is handed out to students, created
                        using files from src/. 
hello-handout.tar       Archive of hello-handout directory
autograde.tar           File that is copied to the autograding instance 
                        (along with autograde-Makefile and student handin file)

# Files created and managed by Autolab
handin/    All students handin files
hello.rb   Config file
hello.yml  Database properties that persist from semester to semester
log.txt    Log of autograded submissions
</pre></div>
</td></tr></table>

<p>The key idea with this directory structure is to place <em>all</em> code for the lab in the <code>src</code> directory, including the autograding code and any starter code handed out to students in the handout directory (<code>hello-handout.tar</code> in this example). Keeping all hard state in the <code>src</code> directory helps limit inconsistencies. </p>
<p>The main makefile creates <code>hello-handout</code> by copying files from <code>src</code>, and then tars it up:</p>
<p><a href="https://github.com/autolab/Autolab/tree/master/examples/hello/Makefile">hello/Makefile</a>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c">#</span>
<span class="c"># Makefile to manage the example Hello Lab</span>
<span class="c">#</span>

<span class="c"># Get the name of the lab directory</span>
<span class="nv">LAB</span> <span class="o">=</span> <span class="k">$(</span>notdir <span class="k">$(</span>PWD<span class="k">))</span>

<span class="nf">all</span><span class="o">:</span> <span class="n">handout</span> <span class="n">handout</span>-<span class="n">tarfile</span>

<span class="nf">handout</span><span class="o">:</span> 
<span class="c">    # Rebuild the handout directory that students download</span>
    <span class="o">(</span>rm -rf <span class="k">$(</span>LAB<span class="k">)</span>-handout<span class="p">;</span> mkdir <span class="k">$(</span>LAB<span class="k">)</span>-handout<span class="o">)</span>
    cp -p src/Makefile-handout <span class="k">$(</span>LAB<span class="k">)</span>-handout/Makefile
    cp -p src/README-handout <span class="k">$(</span>LAB<span class="k">)</span>-handout/README
    cp -p src/hello.c-handout <span class="k">$(</span>LAB<span class="k">)</span>-handout/hello.c 
    cp -p src/driver.sh <span class="k">$(</span>LAB<span class="k">)</span>-handout

<span class="nf">handout-tarfile</span><span class="o">:</span> <span class="n">handout</span>
<span class="c">    # Build *-handout.tar and autograde.tar</span>
    tar cvf <span class="k">$(</span>LAB<span class="k">)</span>-handout.tar <span class="k">$(</span>LAB<span class="k">)</span>-handout
    cp -p <span class="k">$(</span>LAB<span class="k">)</span>-handout.tar autograde.tar

<span class="nf">clean</span><span class="o">:</span>
<span class="c">    # Clean the entire lab directory tree.  Note that you can run</span>
<span class="c">    # &quot;make clean; make&quot; at any time while the lab is live with no</span>
<span class="c">    # adverse effects.</span>
    rm -f *~ *.tar
    <span class="o">(</span><span class="nb">cd</span> src<span class="p">;</span> make clean<span class="o">)</span>
    <span class="o">(</span><span class="nb">cd</span> test-autograder<span class="p">;</span> make clean<span class="o">)</span>
    rm -rf <span class="k">$(</span>LAB<span class="k">)</span>-handout
    rm -f autograde.tar
<span class="c">#</span>
<span class="c"># CAREFULL!!! This will delete all student records in the logfile and</span>
<span class="c"># in the handin directory. Don&#39;t run this once the lab has started.</span>
<span class="c"># Use it to clean the directory when you are starting a new version</span>
<span class="c"># of the lab from scratch, or when you are debugging the lab prior</span>
<span class="c"># to releasing it to the students.</span>
<span class="c">#</span>
<span class="nf">cleanallfiles</span><span class="o">:</span>
<span class="c">    # Reset the lab from scratch.</span>
    make clean
    rm -f log.txt
    rm -rf handin/*
</pre></div>
</td></tr></table>

<p>Filenames are disambiguated by appending <code>-handout</code>, which is stripped when they are copied to the handout directory. For example, <code>src/hello.c</code> is the instructor's solution file, and <code>src/hello.c-handout</code> is the starter code that is given to the students in <code>hello-handout/hello.c</code>. And <code>src/README</code> is the README for the src directory and <code>src/README-handout</code> is the README that is handed out to students in <code>hello-handout/README</code>.</p>
<p>To build the lab, type <code>make clean; make</code>. You can do this as often as you like while the lab is live with no adverse effects. However, be careful to never type <code>make cleanallfiles</code> while the lab is live; this should only be done before the lab goes live; never during or after.</p>
<h3 id="source-directory">Source Directory</h3>
<p>The <a href="https://github.com/autolab/Autolab/tree/master/examples/hello/src">hello/src/</a> directory 
contains <em>all</em> of the code files for the Hello Lab, including the files that are handed out to students:</p>
<p><a href="https://github.com/autolab/Autolab/tree/master/examples/hello/src/README">hello/src/README</a>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span># Autograder and solution files
Makefile                Makefile and ...
README                  ... README for this directory
driver.sh*              Autograder
hello.c                 Solution hello.c file

# Files that are handed out to students
Makefile-handout        Makefile and ...
README-handout          ... README handed out to students
hello.c-handout         Blank hello.c file handed out to students
</pre></div>
</td></tr></table>

<h3 id="handout-directory">Handout Directory</h3>
<p>The <a href="https://github.com/autolab/Autolab/tree/master/examples/hello/hello-handout/">hello/hello-handout/</a> directory
contains the files that the students will use to work on the lab. It contains no hard state, and is populated entirely with files from <code>hello/src</code>:</p>
<p><a href="https://github.com/autolab/Autolab/tree/master/examples/hello/hello-handout/README">hello/hello-handout/README</a>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">For</span> <span class="n">this</span> <span class="n">lab</span><span class="p">,</span> <span class="n">you</span> <span class="n">should</span> <span class="n">write</span> <span class="n">a</span> <span class="n">tiny</span> <span class="n">C</span> <span class="n">program</span><span class="p">,</span> <span class="n">called</span> <span class="s2">&quot;hello.c&quot;</span><span class="p">,</span>
<span class="n">that</span> <span class="n">prints</span> <span class="s2">&quot;hello, world&quot;</span> <span class="n">to</span> <span class="n">stdout</span> <span class="ow">and</span> <span class="n">then</span> <span class="n">indicates</span> <span class="n">success</span> <span class="n">by</span>
<span class="n">exiting</span> <span class="k">with</span> <span class="n">a</span> <span class="n">status</span> <span class="n">of</span> <span class="n">zero</span><span class="o">.</span>

<span class="n">To</span> <span class="n">test</span> <span class="n">your</span> <span class="n">work</span><span class="p">:</span> 
<span class="err">$</span> <span class="n">make</span> <span class="n">clean</span><span class="p">;</span> <span class="n">make</span><span class="p">;</span> <span class="o">./</span><span class="n">hello</span>

<span class="n">To</span> <span class="n">run</span> <span class="n">the</span> <span class="n">same</span> <span class="n">autograder</span> <span class="n">that</span> <span class="n">Autolab</span> <span class="n">will</span> <span class="n">use</span> <span class="n">when</span> <span class="n">you</span> <span class="n">submit</span><span class="p">:</span>
<span class="err">$</span> <span class="o">./</span><span class="n">driver</span><span class="o">.</span><span class="n">sh</span>

<span class="n">Files</span><span class="p">:</span>
<span class="n">README</span>          <span class="n">This</span> <span class="nb">file</span>
<span class="n">Makefile</span>        <span class="n">Compiles</span> <span class="n">hello</span><span class="o">.</span><span class="n">c</span>
<span class="n">driver</span><span class="o">.</span><span class="n">sh</span>       <span class="n">Autolab</span> <span class="n">autograder</span>
<span class="n">hello</span><span class="o">.</span><span class="n">c</span>         <span class="n">Empty</span> <span class="n">C</span> <span class="nb">file</span> <span class="n">that</span> <span class="n">you</span> <span class="n">will</span> <span class="n">edit</span>
</pre></div>
</td></tr></table>

<p><a href="https://github.com/autolab/Autolab/tree/master/examples/hello/hello-handout/Makefile">hello/hello-handout/Makefile</a> contains the rules that compile the student source code:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1"># Student makefile for the Hello Lab</span>
all: 
    gcc hello.c -o hello

clean:
    rm -rf *~ hello
</pre></div>
</td></tr></table>

<p>To compile and run their code, students type:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span> <span class="n">make</span> <span class="n">clean</span><span class="p">;</span> <span class="n">make</span>
<span class="err">$</span> <span class="o">./</span><span class="n">hello</span>
</pre></div>
</td></tr></table>

<h3 id="autograder">Autograder</h3>
<p>The autograder for the Hello Lab is a trivially simple bash script called <code>driver.sh</code> that compiles and runs <code>hello.c</code> and verifies that it returns with an exit status of zero:</p>
<p><a href="https://github.com/autolab/Autolab/tree/master/examples/hello/src/driver.sh">hello/src/driver.sh</a> </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># driver.sh - The simplest autograder we could think of. It checks</span>
<span class="c1">#   that students can write a C program that compiles, and then</span>
<span class="c1">#   executes with an exit status of zero.</span>
<span class="c1">#   Usage: ./driver.sh</span>

<span class="c1"># Compile the code</span>
<span class="nb">echo</span> <span class="s2">&quot;Compiling hello.c&quot;</span>
<span class="o">(</span>make clean<span class="p">;</span> make<span class="o">)</span>
<span class="nv">status</span><span class="o">=</span><span class="nv">$?</span>
<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">status</span><span class="si">}</span> -ne <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Failure: Unable to compile hello.c (return status = </span><span class="si">${</span><span class="nv">status</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;{\&quot;scores\&quot;: {\&quot;Correctness\&quot;: 0}}&quot;</span>
    <span class="nb">exit</span>
<span class="k">fi</span>

<span class="c1"># Run the code</span>
<span class="nb">echo</span> <span class="s2">&quot;Running ./hello&quot;</span>
./hello
<span class="nv">status</span><span class="o">=</span><span class="nv">$?</span>
<span class="k">if</span> <span class="o">[</span> <span class="si">${</span><span class="nv">status</span><span class="si">}</span> -eq <span class="m">0</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;Success: ./hello runs with an exit status of 0&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;{\&quot;scores\&quot;: {\&quot;Correctness\&quot;: 100}}&quot;</span>
<span class="k">else</span>
    <span class="nb">echo</span> <span class="s2">&quot;Failure: ./hello fails or returns nonzero exit status of </span><span class="si">${</span><span class="nv">status</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="nb">echo</span> <span class="s2">&quot;{\&quot;scores\&quot;: {\&quot;Correctness\&quot;: 0}}&quot;</span>
<span class="k">fi</span>

<span class="nb">exit</span>
</pre></div>
</td></tr></table>

<p>For example:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span> <span class="o">./</span><span class="n">driver</span><span class="o">.</span><span class="n">sh</span>
<span class="c1"># Compiling hello.c</span>
<span class="c1"># rm -rf *~ hello</span>
<span class="c1"># gcc hello.c -o hello</span>
<span class="c1"># Running ./hello</span>
<span class="c1"># Hello, world</span>
<span class="c1"># Success: ./hello runs with an exit status of 0</span>
<span class="c1"># {&quot;scores&quot;: {&quot;Correctness&quot;: 100}}</span>
</pre></div>
</td></tr></table>

<p>Notice that the autograder expects the <code>hello</code> lab on the Autolab front-end to have been defined with a problem called "Correctness", with a maximum value of 100 points. If you forget to define the problems listed in the JSON autoresult, scores will still be logged, but they won't be posted to the database. </p>
<h3 id="required-autograding-files">Required Autograding Files</h3>
<p>Autolab requires two <em>autograding files</em> called <code>autograde.tar</code>, which contains all of the code required by the autograder, and <code>autograde-Makefile</code>, which runs the autograder on the autograding image when each submission is graded.</p>
<p>For the Hello Lab, <code>autograde.tar</code> is simply a copy of the <code>hello-handout.tar</code> file that is handed out to students. And here is the corresponding 
<a href="https://github.com/autolab/Autolab/tree/master/examples/hello/autograde-Makefile">hello/autograde-makefile</a>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">all</span><span class="o">:</span>
    <span class="n">tar</span> <span class="n">xvf</span> <span class="n">autograde</span><span class="o">.</span><span class="na">tar</span>
    <span class="n">cp</span> <span class="n">hello</span><span class="o">.</span><span class="na">c</span> <span class="n">hello</span><span class="o">-</span><span class="n">handout</span>
    <span class="o">(</span><span class="n">cd</span> <span class="n">hello</span><span class="o">-</span><span class="n">handout</span><span class="o">;</span> <span class="o">./</span><span class="n">driver</span><span class="o">.</span><span class="na">sh</span><span class="o">)</span>

<span class="n">clean</span><span class="o">:</span>
    <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="o">*~</span> <span class="n">hello</span><span class="o">-</span><span class="n">handout</span>
</pre></div>
</td></tr></table>

<p>The makefile expands <code>autograde.tar</code> into <code>hello-handout</code>, copies <code>hello.c</code> (the submission file) into <code>hello-handout</code>, changes directory to <code>hello-handout</code>, builds the autograder, and then runs it. </p>
<h3 id="test-directory">Test Directory</h3>
<p>For our labs, we like to setup a test directory (called <code>test-autograder</code> in this example), that allows us to test our <code>autograde-Makefile</code> and <code>autograde-tar</code> files by simulating Autolab's behavior on the autograding instance. The <code>test-autograder</code> directory has the following form:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span> <span class="n">cd</span> <span class="n">test</span><span class="o">-</span><span class="n">autograder</span>
<span class="err">$</span> <span class="n">ls</span> <span class="o">-</span><span class="n">l</span>
<span class="c1"># total 3</span>
<span class="c1"># lrwxr-xr-x 1 droh users  21 Aug  4 16:43 Makefile -&gt; ../autograde-Makefile</span>
<span class="c1"># lrwxr-xr-x 1 droh users  16 Aug  4 16:43 autograde.tar -&gt; ../autograde.tar</span>
<span class="c1"># -rw-rw-r-- 1 droh users 113 Aug  4 16:44 hello.c</span>
</pre></div>
</td></tr></table>

<p>To simulate Autolab's behavior on an autograding instance:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="err">$</span> <span class="n">cd</span> <span class="n">test</span><span class="o">-</span><span class="n">autograder</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">clean</span> <span class="o">&amp;&amp;</span> <span class="n">make</span>
<span class="c1"># Running ./hello</span>
<span class="c1"># Hello, world</span>
<span class="c1"># Success: ./hello runs with an exit status of 0</span>
<span class="c1"># {&quot;scores&quot;: {&quot;Correctness&quot;: 100}}</span>
</pre></div>
</td></tr></table>

<h3 id="writeup-directory">Writeup directory</h3>
<p>The <code>hello/writeup</code> contains the detailed lab writeup, either html or pdf file, that students can download from the Autolab front end.</p>
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../instructors/" title="Guide for Instructors" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Guide for Instructors
              </span>
            </div>
          </a>
        
        
          <a href="../tango/" title="Getting Started" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Getting Started
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/Autolab" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://facebook.com/autolabproject" class="md-footer-social__link fa fa-facebook"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application-7f35cda7dd.js"></script>
      <script>var config={url:{base:".."}},app=new Application(config);app.initialize()</script>
      
    
    
      
    
  </body>
</html>